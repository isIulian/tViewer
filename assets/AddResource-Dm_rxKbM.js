import{r as y,k as e,l as p,B as m,I as f,L as V,p as L,q as _}from"./index-PsDayEUa.js";import{z as t,u as D,a as g,F as $,b as l,c as n,d as c,e as i,f as d,g as x,t as B}from"./form-BRuEqSF8.js";import{S as b,a as S,b as T,c as N,d as C}from"./select-8kfTUmTh.js";import{I as h}from"./input-BhSdzqM9.js";import{T as E,s as G}from"./data-CfxBc-PR.js";import{r as H}from"./resourcesService-Dcwbatao.js";import{r as M}from"./resourceTypeService-VxB1GVOX.js";import{T as U}from"./theme-switch-DuQNpLzg.js";const X=t.object({title:t.string({required_error:"Please set a resource title."}),resourceType:t.string({required_error:"Please specify the resource type."}),description:t.string({required_error:"Please wirte a short description."}),status:t.string({required_error:"Please set status."}),covers:t.array(t.object({value:t.string().url({message:"Please enter a valid URL."})})).optional(),parts:t.array(t.object({value:t.string({required_error:"Please enter a part name."})})).nonempty("At least on part is required")}),J={parts:[{value:"only part"}]};function K(){const[j,F]=y.useState([]);y.useEffect(()=>{(async()=>{let r=await M.getTypes();F(r)})()},[]);const a=D({resolver:B(X),defaultValues:J,mode:"onChange"}),{fields:A,append:P,remove:z}=g({name:"covers",control:a.control}),{fields:R,append:k,remove:q}=g({name:"parts",control:a.control});function w(s){var v;let r=parseInt(s.resourceType,10),o=(v=j.find(u=>u.id===r))==null?void 0:v.name,I={type:r,title:s.title,description:s.description,status:s.status,covers:s.covers.map(u=>u.value),parts:s.parts.map(u=>u.value)};H.createResource(I).then(function(){window.location.href=`/tViewer/resources/${o}`})}return e.jsx($,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(w),className:"space-y-8",children:[e.jsx(l,{control:a.control,name:"resourceType",render:({field:s})=>e.jsxs(n,{children:[e.jsx(c,{children:"Type"}),e.jsxs(b,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(i,{children:e.jsx(S,{children:e.jsx(T,{placeholder:"Select a type"})})}),e.jsx(N,{children:j.map((r,o)=>e.jsx(C,{value:String(r.id),children:r.name},o))})]}),e.jsx(d,{})]})}),e.jsx(l,{control:a.control,name:"title",render:({field:s})=>e.jsxs(n,{children:[e.jsx(c,{children:"Title"}),e.jsx(i,{children:e.jsx(h,{placeholder:"resource title/name",...s})}),e.jsx(d,{})]})}),e.jsx(l,{control:a.control,name:"description",render:({field:s})=>e.jsxs(n,{children:[e.jsx(c,{children:"Description"}),e.jsx(i,{children:e.jsx(E,{placeholder:"Tell us about the resource",className:"resize-none",...s})}),e.jsx(x,{children:"Give a short description of what the resource is talking about."}),e.jsx(d,{})]})}),e.jsx(l,{control:a.control,name:"status",render:({field:s})=>e.jsxs(n,{children:[e.jsx(c,{children:"Status"}),e.jsxs(b,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(i,{children:e.jsx(S,{children:e.jsx(T,{placeholder:"Select status"})})}),e.jsx(N,{children:G.map((r,o)=>e.jsx(C,{value:r.value,children:r.label},o))})]}),e.jsx(d,{})]})}),e.jsxs("div",{children:[A.map((s,r)=>e.jsx(l,{control:a.control,name:`covers.${r}.value`,render:({field:o})=>e.jsxs(n,{children:[e.jsx(c,{className:p(r!==0&&"sr-only"),children:"Covers"}),e.jsx(x,{className:p(r!==0&&"sr-only"),children:"Add urls of cover to the resource."}),e.jsx(i,{children:e.jsxs("div",{className:"flex",children:[e.jsx(h,{...o}),e.jsx(m,{type:"button",variant:"ghost",className:"ml-1",size:"sm",onClick:()=>z(r),children:e.jsx(f,{size:14})})]})}),e.jsx(d,{})]})},s.id)),e.jsx(m,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>P({value:""}),children:"Add Cover"})]}),e.jsxs("div",{children:[R.map((s,r)=>e.jsx(l,{control:a.control,name:`parts.${r}.value`,render:({field:o})=>e.jsxs(n,{children:[e.jsx(c,{className:p(r!==0&&"sr-only"),children:"Parts"}),e.jsx(x,{className:p(r!==0&&"sr-only"),children:"Add part or parts of the resource."}),e.jsx(i,{children:e.jsxs("div",{className:"flex",children:[e.jsx(h,{...o}),e.jsx(m,{type:"button",variant:"ghost",className:"ml-1",size:"sm",onClick:()=>q(r),children:e.jsx(f,{size:14})})]})}),e.jsx(d,{})]})},s.id)),e.jsx(m,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>k({value:""}),children:"Add Part"})]}),e.jsx(m,{type:"submit",children:"Add"})]})})}function te(){return e.jsxs(V,{children:[e.jsxs(L,{className:"border-b",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Add resource"}),e.jsx("div",{className:"ml-auto flex items-center space-x-4",children:e.jsx(U,{})})]}),e.jsx(_,{className:"space-y-4",children:e.jsx(K,{})})]})}export{te as default};
